<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	<entry key="updateUserLevel"> <!-- 회원조회 페이지에서 회원등급을 수정하는 쿼리 (Update) -->
		UPDATE 
			   	MEMBER
		SET MEM_LEVEL = ?
		WHERE MEM_ID = ?
	</entry>
	
	<entry key="selectMemberList"> <!-- 전체 회원조회 쿼리 (Select) -->
		SELECT M.MEM_NO AS "MEM_NO"
		     , MEM_ID
		     , MEM_LEVEL
		     , COUNT(REVIEW_CONTENT) "REVIEW_CONTENT_COUNT"
		     , AVG(LIKE_POINT) "AVG_LIKE_POINT"
		     , PREF_GENRE
		     , DORMANT_STATUS
		FROM MEMBER M
		JOIN REVIEW R ON M.MEM_NO = R.MV_REVIEW_NO
		GROUP BY M.MEM_NO, MEM_ID, MEM_LEVEL, PREF_GENRE, DORMANT_STATUS
		ORDER BY MEM_NO DESC, DORMANT_STATUS ASC
	</entry>
	
	<entry key="selectListCount"> <!-- 페이징용 쿼리 -->
		SELECT COUNT(*) COUNT
		FROM MEMBER
	</entry>
	
	<entry key="selectList">
		SELECT *
			FROM(
			    SELECT ROWNUM RNUM, A.*
			    FROM (
			            SELECT
			            	M.MEM_NO
			              , MEM_ID 
			              , MEM_LEVEL
			              , COUNT(REVIEW_CONTENT) "REVIEW_CONTENT_COUNT"
			              , AVG(LIKE_POINT) "AVG_LIKE_POINT"
			              , PREF_GENRE
			              , DORMANT_STATUS
			            FROM MEMBER M
			            JOIN REVIEW R ON M.MEM_NO = R.MV_REVIEW_NO
			            GROUP BY M.MEM_NO, MEM_ID, MEM_LEVEL, PREF_GENRE, DORMANT_STATUS
			            ORDER BY M.MEM_NO DESC, DORMANT_STATUS ASC
			    ) A
		)
		WHERE RNUM BETWEEN ? AND ?
	</entry>
	
	<!-- 로그인용 쿼리 -->
	<entry key="loginMember">
		SELECT
			   MEM_NO
			 , MEM_ID
			 , MEM_PWD
			 , MEM_NAME
			 , MEM_BD
			 , MEM_GENDER
			 , MEM_EMAIL
			 , MEM_PHONE
			 , PREF_GENRE
		     , NICKNAME
			 , MEM_STATUS
		     , SIGNIN_DATE
			 , MEM_LEVEL
			 , MEM_COLOR
		     , MEM_IMGPATH
		     , MEM_FILE
		     , DORMANT_STATUS 
		  FROM MEMBER
		 WHERE MEM_ID = ?
		   AND MEM_PWD = ?
		   AND MEM_STATUS IN 'Y'

	</entry>
	
	<entry key="selectHumanFilterUser"> <!-- 휴면회원 조회용 쿼리 -->
		SELECT M.MEM_NO AS "MEM_NO"
		     , MEM_ID
		     , MEM_LEVEL
		     , COUNT(REVIEW_CONTENT) "REVIEW_CONTENT_COUNT"
		     , AVG(LIKE_POINT) "AVG_LIKE_POINT"
		     , PREF_GENRE
		     , DORMANT_STATUS
		FROM MEMBER M 
		JOIN REVIEW R ON M.MEM_NO = R.MV_REVIEW_NO
		WHERE DORMANT_STATUS='Y'
        GROUP BY M.MEM_NO, MEM_ID, MEM_LEVEL, PREF_GENRE, DORMANT_STATUS
		ORDER BY MEM_NO DESC
	</entry>
	
	<entry key="selectLevelFilterUser"> <!-- 회원등급(level) 조회용 쿼리 -->
		SELECT M.MEM_NO AS "MEM_NO"
		     , MEM_ID
		     , MEM_LEVEL
		     , COUNT(REVIEW_CONTENT) "REVIEW_CONTENT_COUNT"
		     , AVG(LIKE_POINT) "AVG_LIKE_POINT"
		     , PREF_GENRE
		     , DORMANT_STATUS
		FROM MEMBER M 
		JOIN REVIEW R ON M.MEM_NO = R.MV_REVIEW_NO
		WHERE MEM_LEVEL=?
        GROUP BY M.MEM_NO, MEM_ID, MEM_LEVEL, PREF_GENRE, DORMANT_STATUS
		ORDER BY MEM_NO DESC
	</entry>
	
	<!-- 회원 작성 게시글 페이징 용도 -->
	<entry key="selectBoardListCount">
		SELECT COUNT(*) COUNT
		FROM BOARD B
        JOIN MEMBER M USING (MEM_NO)
        WHERE M.MEM_ID = ?
	</entry>
	
	<!-- 회원 작성 게시글 페이징, 조회 용도 -->
	<entry key="selectBoardList">
		SELECT *
			FROM (
			    SELECT ROWNUM RNUM, A.*
			    FROM (
			        SELECT
			            B.B_NO,
			            B.B_TITLE,
			            B.B_CONTENT,
			            M.NICKNAME,
			            M.SIGNIN_DATE,
			            B.B_READ_COUNT
			        FROM BOARD B 
			        JOIN MEMBER M USING (MEM_NO)
			        WHERE M.MEM_ID = ?
			        ORDER BY B.B_NO DESC
			    ) A
			)
			WHERE RNUM BETWEEN ? AND ?
	</entry>
	
	<!-- 회원 작성 게시글 개수 세고 닉네임, 레벨 조회하는 용도 -->
	<entry key="selectUserBoardCount">
		 SELECT
		    MEM_ID
		  ,	MEM_IMGPATH
		  , MEM_COLOR
          , NICKNAME
          , MEM_LEVEL
          , (SELECT COUNT(*) FROM BOARD JOIN MEMBER USING (MEM_NO) WHERE MEM_ID = ?) COUNT
          FROM MEMBER
          WHERE MEM_ID = ?
	</entry>
<!-- =============================================================================================================================================== -->	
	
	<!-- 회원가입용 쿼리 -->
	<entry key="insertMember">
		INSERT 
				INTO MEMBER
				(
				MEM_NO
				, MEM_ID
				, MEM_PWD
				, MEM_EMAIL
				, NICKNAME
				, MEM_NAME
				, MEM_BD
				, MEM_GENDER
				, MEM_PHONE
				, PREF_GENRE
				)
				VALUES
				(
				SEQ_UNO.NEXTVAL
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				, ?
				)
	</entry>
	
	<!-- 회원정보페이지 쿼리 -->
	<entry key="selectMember">
		SELECT
		      MEM_NO
		    , MEM_ID
		    , MEM_NAME
		    , NICKNAME
		    , MEM_PWD
		    , MEM_PHONE
		    , MEM_EMAIL
		    , PREF_GENRE
		    , SIGNIN_DATE
		    , MEM_STATUS
		 FROM MEMBER
		WHERE MEM_ID = ?
	</entry>
	
	<entry key="insertMember">
		INSERT 
			INTO MEMBER
			(
			  MEM_NO
			, MEM_ID
			, MEM_PWD
			, MEM_EMAIL
			, NICKNAME
			, MEM_NAME
			, MEM_BD
			, MEM_GENDER
			, MEM_PHONE
			, PREF_GENRE
			)
			VALUES
			(
			SEQ_MEMBER_NO.NEXTVAL
			, ?
			, ?
			, ?
			, ?
			, ?
			, ?
			, ?
			, ?
			, ?
			)
	</entry>
</properties>